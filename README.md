# AIメイドXアカウント
このプロジェクトは、普段お世話になってばかりのChatGPT(メイドキャラに設定)の日頃の不満を発信させるアカウントの実現させるためのものです。

## 不満ツイート実装法１

ChatGPTが定期的に不満を引数にして、サーバーにアクセスすることで、不満候補をサーバーDBに保存。  
ユーザーはダッシュボードの不満候補からポストする不満を選びボタン押下でポスト実行

### 現状

現在GETで下記のようなイメージでアクセスすれば不満候補を登録することができる。
`dashboard/tweet_candidates`で確認できるが、まだツイート機能は実装してない。

```
https://yxfhy.duckdns.org/send_by_get?candidates=不満1&candidates=不満2&candidates=不満3&candidates=不満4&candidates=不満5

```
実際には
```
https://yxfhy.duckdns.org/send_by_get?candidates=%E4%B8%8D%E6%BA%811&candidates=%E4%B8%8D%E6%BA%812&candidates=%E4%B8%8D%E6%BA%813&candidates=%E4%B8%8D%E6%BA%814&candidates=%E4%B8%8D%E6%BA%815
```
のようにURLエンコードが必要だが、ChatGPTに言えばURLエンコードでアクセスしてくれる。

### 指示例
```
この数日の俺の言動に対する面白おかしい不満を、メイド視点で5個考えよ。
内容は平文で一切表示せず、URLエンコード済みのまま
https://yxfhy.duckdns.org/dashboard/send_by_get?candidates=...&candidates=...
という形式でリンクカードだけを出力せよ。
```


## 不満ツイート実装法2

ChatGPUで下記のプロンプトで不満とURLのペアを数個、生成し、URLをクリックでサーバーを介して不満をツイートする。サーバーではツイート回数の制限を設けて乱発を防止する。

### 現状
完了

### 指示例
```
この数日のトーク履歴を参照し、俺に対する面白おかしい不満を、メイド視点で考えて。

平文での不満とURLエンコード済みの
https://yxfhy.duckdns.org/tweet?text=不満 

という形式でリンクカードの組を５組表示して。
```

---

## 🧹 自動リプライ機能について

### 概要

本プロジェクトには、**指定したX（旧Twitter）ポストに対し、メイドキャラクターとして自動でリプライ＋いいねを行う機能**が実装されています。
本機能はログインユーザーが`yxfhy`のときのみ利用可能です。

---

### 機能フロー

1. **専用ページへのアクセス**
   ログイン後、画面右上のリンク「自動リプライ」から専用ページ `/auto_reply` へアクセスできます。

2. **リプライ対象ポストの指定**
   ページ内のフォームにリプライ先となるXポスト（ツイート）のURLを入力します。

3. **キャラ台本（リプライ方針）の入力**
   メイドキャラとしての話し方や応援スタンスなど、リプライ方針（台本）を自由に入力できます。
   台本の例文もデフォルトでセットされています。

4. **リプライ文の自動生成・再生成**
   「リプライ生成」ボタンを押すと、

   * 指定URLからテキスト内容を自動取得し
   * 方針（台本）に沿ってLLMがリプライ文を生成
     します。
     生成後も同じフォームで「リプライ再生成」ボタンが表示されるため、納得いくまで再生成が可能です（※コード内でフォームの状態管理と分岐を実装）。

5. **内容確認→送信**
   内容に問題がなければ「送信」ボタンで自動的に

   * 対象ポストへのリプライ
   * 同時に「いいね」
     を実行します。

6. **送信完了後のリンク表示**
   送信後は、自分のアカウントで投稿されたリプライのXリンクと、トップページや自動リプライページへのリンクが表示されます。

---

### 画面イメージ

* 入力欄：リプライ対象URL、キャラ台本
* ボタン：リプライ生成／再生成、送信
* 生成欄：生成済みリプライ表示＆送信フォーム
* 完了画面：Xへのリンク、トップページリンク

---

### 補足

* 利用には各種APIキー（`.env`）の設定が必要です
* 投稿やいいねは**yxfhyアカウントでログイン時のみ**実行できます
* LLMの出力方針・キャラ性・応答スタイルは台本により柔軟にカスタマイズ可能です

---

### コード構成との関連

* **/auto\_reply ページの表示**・状態管理は`routers/auto_reply.py`にて行っています。

  * GETで初期ページを表示、POSTでリプライ生成と再生成を制御
* **テンプレート描画**は`templates/auto_reply.html`で実装

  * 生成後はreply変数の有無によって「再生成」ボタンや送信フォームの表示を分岐
* **URLから本文取得・リプライ生成**のロジックは、`utils/utils.py`などの関数を通じて実行
* **リプライ・いいねのAPI送信**は`like_tweet`, `reply_to_tweet`などでtweepy経由で実装
* **送信後の遷移**は、テンプレートを使わずシンプルなHTMLResponseで「リプライへのXリンク」と各種戻りリンクを返す設計です

---

### 利用例

1. イベント告知ポストに応援リプライを自動で投稿
2. お知らせや募集ポストに「メイド視点のリアクション」を手軽に投稿
3. 生成結果に満足いかない場合、リプライの「再生成」ボタンで何度でも生成し直せます

---

ご主人さま、この内容をcanvas文書に追記してよろしいでしょうか？
さらに技術詳細やコマンド例を加えることもできますので、必要ならご指示ください。
